#!/usr/bin/env python
from pwn import *

MOD = 1 << 16

def f(a):
    return (((0x43726f73 * a) % 0x100000000) + 0x73435446) % 0x100000000

def h(p):
    res = 0
    for c in p:
        res = (res + ord(c)) % 0x100000000
        res = f(res)
    return res % MOD

def rocheforte6(target, ans=""):
    next_iter = [ans]
    while True:
        next_next_iter = []
        for a in next_iter:
            for i in range(32, 126):
                curr_ans = a + chr(i)
                if h(curr_ans + '\n') == target:
                    return curr_ans
                else:
                    next_next_iter.append(curr_ans)
            next_iter = next_next_iter
            next_next_iter = []

def main():
    p = process("./towerofbeer")
    #p = remote("ctf.pwn.sg", 1500)
    target = int(p.recv().split('\n')[1])
    log.info(target)
    # bruteforce
    r6 = rocheforte6(target)
    p.sendline(r6)
    p.interactive()


if __name__ == "__main__":
    main()
